<?xml version="1.0" encoding="UTF-8"?>
<ae:configurations xmlns="http://agavi.org/agavi/config/parts/databases/1.0" xmlns:ae="http://agavi.org/agavi/config/global/envelope/1.0">

    <!--
    ####################
    DEFAULT DATABASE SETTINGS
    ####################
    -->
    <ae:configuration>
        <databases default="News.Write">
            <!-- ASSETS MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Assets.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_assets</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Assets.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">midas_assets</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!-- NEWS MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="News.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="News.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!-- SHOFI MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Shofi.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_shofi</ae:parameter>
                <ae:parameter name="script_dir">%core.modules_dir%/Shofi/config/couchdb</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Shofi.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">midas_shofi</ae:parameter>
                <ae:parameter name="mapping_dir">%core.modules_dir%/Shofi/config/elasticsearch</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
                <ae:parameter name="river">
                    <ae:parameter name="couch_db">midas_news</ae:parameter>
                </ae:parameter>
            </database>

            <!-- MOVIES MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Movies.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_movies</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Movies.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">midas_movies</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Movies.Frontend" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_fe_movies</ae:parameter>
            </database>

            <!-- EVENTS MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Events.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_events</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Events.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">midas_events</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Events.Frontend" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">midas_fe_events</ae:parameter>
            </database>
        </databases>
    </ae:configuration>

    <!--
    ####################
    TESTING DATABASE SETTINGS
    ####################
    -->
    <ae:configuration environment="testing.*">
        <databases default="News.Read">
            <!-- ASSETS MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Assets.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">testing-midas_assets</ae:parameter>  <!-- @todo rename to midas_assets -->
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Assets.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">testing-midas_assets</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!-- NEWS MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="News.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">testing-midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="News.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">testing-midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!-- SHOFI MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Shofi.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">testing-midas_shofi</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Shofi.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">testing-midas_shofi</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!-- MOVIES MODULE COUCH(write) AND ELASTICSEARCH(read) SETTINGS -->
            <database name="Movies.Write" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">testing-midas_movies</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="Movies.Frontend" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">testing-midas_fe_movies</ae:parameter>
            </database>

            <database name="Movies.Read" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">testing-midas_movies</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!--
            ########################
            NEWS FIXTURES - TESTING ONLY DATABASES
            These settings are for fixtures that are used for readonly tests,
            which need a large dataset to work on.
            ########################
            -->
            <database name="News.WriteFixtures" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">fixtures-midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <database name="News.ReadFixtures" class="ElasticSearchDatabase">
                <ae:parameter name="host">127.0.0.1</ae:parameter>
                <ae:parameter name="port">9200</ae:parameter>
                <ae:parameter name="transport">Http</ae:parameter>
                <ae:parameter name="index">fixtures-midas_news</ae:parameter>
                <ae:parameter name="setup">true</ae:parameter>
            </database>

            <!--
                This database connection is used to test the CouchDbDataImport,
                which is currently not integrated into any prod relevant code.
                The Import/RunActionTest relies on this connection to exist.
            -->
            <database name="CouchImport" class="CouchDbDatabase">
                <ae:parameter name="url">http://127.0.0.1:5984/</ae:parameter>
                <ae:parameter name="database">couch_import_testing</ae:parameter>
            </database>
        </databases>
    </ae:configuration>

</ae:configurations>

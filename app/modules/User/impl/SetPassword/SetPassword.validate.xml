<?xml version="1.0" encoding="UTF-8"?>
<ae:configurations
    xmlns="http://agavi.org/agavi/config/parts/validators/1.0"
    xmlns:ae="http://agavi.org/agavi/config/global/envelope/1.0"
    parent="%core.module_dir%/User/config/validators.xml">
    <ae:configuration>
        <validators>

            <validator class="UserTokenValidator" name="invalid_token" method="read" required="true">
                <argument>token</argument>
                <ae:parameter name="token_argument_name">token</ae:parameter>
                <ae:parameter name="export">user</ae:parameter>
            </validator>

            <validator class="PasswordValidator" name="minimum_password_complexity" method="write" required="true">
                <argument>password</argument>
                <error> Your password does not meet the minimum complexity rules.&lt;br/&gt;&lt;br/&gt;
                It must contain at least 6 characters with at least 1 uppercase character, 1 lowercase character and 1 decimal number.
                Please note, that it should also not be too similar to your login name, email or company name.</error>
                <ae:parameters>
                    <!-- basic password security -->
                    <ae:parameter name="min_decimal_numbers">0</ae:parameter>
                    <ae:parameter name="min_uppercase_chars">0</ae:parameter>
                    <ae:parameter name="min_lowercase_chars">0</ae:parameter>
                    <ae:parameter name="min_string_length">10</ae:parameter>
                    <ae:parameter name="max_string_length">32</ae:parameter>
                    <!-- require enough distance from the other user attributes -->
                    <ae:parameter name="argument_names_for_similarity_check">
                        <ae:parameter>firstname</ae:parameter>
                        <ae:parameter>lastname</ae:parameter>
                        <ae:parameter>username</ae:parameter>
                        <ae:parameter>email</ae:parameter>
                    </ae:parameter>
                    <ae:parameter name="similarity_percentage_threshold">70</ae:parameter>
                    <ae:parameter name="minimum_levenshtein_distance">7</ae:parameter>
                    <!-- disallow common passwords -->
                    <ae:parameter name="common_passwords_blacklist_file">%core.modules_dir%/User/config/password_variants_blacklist.txt</ae:parameter>
                    <!-- arguments that hold the required token and optional password challenge -->
                    <ae:parameter name="token_argument_name">token</ae:parameter>
                    <ae:parameter name="repeat_password_argument_name">password_repeat</ae:parameter>
                    <!-- export the validated UserDocument to a 'user' request key -->
                    <ae:parameter name="export">user</ae:parameter>
                    <ae:parameter name="clear_password">true</ae:parameter>
                </ae:parameters>
            </validator>

        </validators>
    </ae:configuration>
</ae:configurations>
